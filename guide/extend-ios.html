<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Extend iOS | Weex</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="Notice#All of the exported APIs in Weex are controllable and safe, they can not access private APIs or do any system hacks at runtime,  neither can they change the primary purpose of the Application.">
<meta property="og:type" content="website">
<meta property="og:title" content="Extend iOS">
<meta property="og:url" content="https://weex.apache.org/guide/extend-ios.html">
<meta property="og:site_name" content="Weex">
<meta property="og:description" content="Notice#All of the exported APIs in Weex are controllable and safe, they can not access private APIs or do any system hacks at runtime,  neither can they change the primary purpose of the Application.">
<meta property="og:locale" content="en">
<meta property="og:updated_time" content="2018-01-18T03:32:16.487Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Extend iOS">
<meta name="twitter:description" content="Notice#All of the exported APIs in Weex are controllable and safe, they can not access private APIs or do any system hacks at runtime,  neither can they change the primary purpose of the Application.">
  
    <link rel="alternate" href="/atom.xml" title="Weex" type="application/atom+xml">
  
  
    <link rel="icon" href="//gw.alicdn.com/tps/TB1XNqxPXXXXXcSXVXXXXXXXXXX-64-63.png">
  
  
    <link rel="stylesheet" href="/css/docsearch.min.css">
  
  <link rel="stylesheet" href="/css/style.css">
  <link rel="stylesheet" href="/css/swiper.min.css">
</head>
<body id="guide" class="lang-en">
  
  <script>
    window.PAGE_TYPE = "guide";
    window.ROOT = "/"
  </script>
  <header id="header">
  <div class="navbar">
    <a id="logo" href="/">
      <img src="//img.alicdn.com/tps/TB1zBLaPXXXXXXeXXXXXXXXXXXX-121-59.svg" />
    </a>
    <div class="main-nav">
      <ul class="links">
        <li class="current">
          <a href="/guide">Guide</a>
        </li>
        <li class="">
          <a href="/references">References</a>
        </li>
        <li class="">
          <a href="/wiki">WiKi</a>
        </li>
        <li class="dropdown ">
          <a>Tools</a>
          <ul class="dropdown-menu subnav">
            <li>
              <a target="_blank" href="http://dotwe.org/vue/">Online Playground</a>
            </li>
            <li>
              <a href="/tools/playground.html">Playground App</a>
            </li>
            <li>
              <a href="/tools/toolkit.html">weex-toolkit</a>
            </li>
            <li>
              <a target="_blank" href="https://market.dotwe.org/">Weex Market</a>
            </li>
            <li>
              <a href="/tools/helpers.html">Helpers</a>
            </li>
          </ul>
        </li>
        <li class="dropdown ">
          <a href="javascript:;">Community</a>
          <ul class="dropdown-menu subnav">
            <li>
              <a href="/contributing.html">How to Contribute</a>
            </li>
            <li>
              <a href="/bug-report-guidelines.html">Bug Report Guidelines</a>
            </li>
            <li>
              <a href="/development-process.html">Development Process</a>
            </li>
            <li>
              <a href="/resources.html">Resources</a>
            </li>
            <li>
              <a href="/releasenote.html">Release Note</a>
            </li>
            <li>
              <a href="/who-is-using-weex.html">Who is using Weex?</a>
            </li>
            <li>
              <a target="_blank" href="https://hanks10100.github.io/weex-vue-examples/">Examples</a>
            </li>
          </ul>
        </li>
      </ul>
      <ul class="tools">
        <li>
          <div class="search">
  <form id="search-form" class="search-form"> <!-- 搜索框相关 -->
    <input type="text" id="search-input-header" name="q" results="0" class="form-control search-input" autocomplete="off" autocorrect="off"/>
    <span class="iconfont icon-search"></span>
  </form>
  <div class="results-panel">
  </div>
</div>
        </li>
        <li>
          <div class="dropdown select-lang">
            <a href="javascript:;" class="dropdown-toggle">
              Language
              <span class="caret"></span>
            </a>
            <ul class="dropdown-menu pick-lang">
              <li>
                <a href="/guide/extend-ios.html" data-lang="en">English</a>
              </li>
              <li>
                <a href="/cn/guide/extend-ios.html" data-lang="zh-cn">中文</a>
              </li>
            </ul>
          </div>
        </li>
        <!--<li></li>-->
      </ul>
      <ul>
        <li><a href="https://github.com/apache/incubator-weex/" target="_blank"><span class="btn-github iconfont icon-github"></span></a></li>
      </ul>
    </div>
  </div>
  <div id="mobile-nav">
    <a id="logo" href="/">
      <img src="//img.alicdn.com/tps/TB1zBLaPXXXXXXeXXXXXXXXXXXX-121-59.svg" />
    </a>
    <a class="btn-menu"><span class="iconfont icon-nav"></span></a>
  </div>
</header>

  <div id="sidebar" class="">
  <div class="sidebar-menu">
    
      <div class="search">
  <form id="search-form" class="search-form"> <!-- 搜索框相关 -->
    <input type="text" id="search-input-sidebar" name="q" results="0" class="form-control search-input" autocomplete="off" autocorrect="off"/>
    <span class="iconfont icon-search"></span>
  </form>
  <div class="results-panel">
  </div>
</div>
      


<div class="summary">
  <ul class="doc-summary">
    
    
    
      
      
        
      
    
      
      
        
      
    
      
      
        
      
    
      
      
        
      
    
      
      
        
      
    
      
      
        
      
    
      
      
        
      
    
      
      
        
      
    
      
      
        
      
    
      
      
        
      
    
      
      
        
      
    
      
      
        
      
    
      
      
        
      
    
      
      
        
      
    
      
      
        
      
    
      
      
        
      
    
      
      
        
      
    

    
      <li>
          <h3 class="chapter-title">
            
            
              <span class="sidebar-link">Overview</span>
            
          </h3>
          

        
          <ul class="chapter">
            
              
                <li>
                  <a href="/guide/index.html" class="sidebar-link  ">Getting Started</a>
                </li>
              
            
              
                <li>
                  <a href="/guide/integrate-to-your-app.html" class="sidebar-link  ">Integrate to Your App</a>
                </li>
              
            
              
                <li>
                  <a href="/guide/front-end-frameworks.html" class="sidebar-link  ">Front-End Frameworks</a>
                </li>
              
            
              
                <li>
                  <a href="/guide/use-vue.html" class="sidebar-link  ">Use Vue.js on Weex</a>
                </li>
              
            
          </ul>
        
      </li>
    
      <li>
          <h3 class="chapter-title">
            
            
              <span class="sidebar-link">Develop</span>
            
          </h3>
          

        
          <ul class="chapter">
            
              
                <li>
                  <a href="/guide/set-up-env.html" class="sidebar-link  ">Setup Develop Environment</a>
                </li>
              
            
              
                <li>
                  <a href="/guide/integrate-devtool-to-android.html" class="sidebar-link  ">Integrate Devtool to Android</a>
                </li>
              
            
              
                <li>
                  <a href="/guide/integrate-devtool-to-ios.html" class="sidebar-link  ">Integrate Devtool to iOS</a>
                </li>
              
            
          </ul>
        
      </li>
    
      <li>
          <h3 class="chapter-title">
            
            
              <span class="sidebar-link">Extend</span>
            
          </h3>
          

        
          <ul class="chapter">
            
              
                <li>
                  <a href="/guide/create-a-plugin.html" class="sidebar-link  ">Create a plugin</a>
                </li>
              
            
              
                <li>
                  <a href="/guide/extend-web-render.html" class="sidebar-link  ">Extend Web Renderer</a>
                </li>
              
            
              
                <li>
                  <a href="/guide/extend-android.html" class="sidebar-link  ">Extend Android</a>
                </li>
              
            
              
                <li>
                  <a href="/guide/extend-ios.html" class="sidebar-link current ">Extend iOS</a>
                </li>
              
            
              
                <li>
                  <a href="/guide/extend-js-framework.html" class="sidebar-link  ">Extend JS framework</a>
                </li>
              
            
          </ul>
        
      </li>
    
      <li>
          <h3 class="chapter-title">
            
            
              <span class="sidebar-link">Advanced Guide</span>
            
          </h3>
          

        
          <ul class="chapter">
            
              
                <li>
                  <a href="/guide/advanced/path.html" class="sidebar-link  ">Asset Path</a>
                </li>
              
            
              
                <li>
                  <a href="/guide/advanced/downgrade.html" class="sidebar-link  ">Downgrade</a>
                </li>
              
            
              
                <li>
                  <a href="/guide/advanced/use-vuex-and-vue-router.html" class="sidebar-link  ">Use Vuex and vue-router</a>
                </li>
              
            
              
                <li>
                  <a href="/guide/advanced/app-architecture.html" class="sidebar-link  ">Mobile App Architecture</a>
                </li>
              
            
              
                <li>
                  <a href="/guide/advanced/page-architecture.html" class="sidebar-link  ">Weex Page Architecture</a>
                </li>
              
            
          </ul>
        
      </li>
    
  </ul>
</div>

    
    <a class="btn-close-sidebar iconfont  icon-close"></a>
  </div>
</div>

  

<div class="main-content">
  <div class="article-wrapper page-layout with-chapter">
    
      <div class="doc-nav">
        


<div class="summary">
  <ul class="doc-summary">
    
    
    
      
      
        
      
    
      
      
        
      
    
      
      
        
      
    
      
      
        
      
    
      
      
        
      
    
      
      
        
      
    
      
      
        
      
    
      
      
        
      
    
      
      
        
      
    
      
      
        
      
    
      
      
        
      
    
      
      
        
      
    
      
      
        
      
    
      
      
        
      
    
      
      
        
      
    
      
      
        
      
    
      
      
        
      
    

    
      <li>
          <h3 class="chapter-title">
            
            
              <span class="sidebar-link">Overview</span>
            
          </h3>
          

        
          <ul class="chapter">
            
              
                <li>
                  <a href="/guide/index.html" class="sidebar-link  ">Getting Started</a>
                </li>
              
            
              
                <li>
                  <a href="/guide/integrate-to-your-app.html" class="sidebar-link  ">Integrate to Your App</a>
                </li>
              
            
              
                <li>
                  <a href="/guide/front-end-frameworks.html" class="sidebar-link  ">Front-End Frameworks</a>
                </li>
              
            
              
                <li>
                  <a href="/guide/use-vue.html" class="sidebar-link  ">Use Vue.js on Weex</a>
                </li>
              
            
          </ul>
        
      </li>
    
      <li>
          <h3 class="chapter-title">
            
            
              <span class="sidebar-link">Develop</span>
            
          </h3>
          

        
          <ul class="chapter">
            
              
                <li>
                  <a href="/guide/set-up-env.html" class="sidebar-link  ">Setup Develop Environment</a>
                </li>
              
            
              
                <li>
                  <a href="/guide/integrate-devtool-to-android.html" class="sidebar-link  ">Integrate Devtool to Android</a>
                </li>
              
            
              
                <li>
                  <a href="/guide/integrate-devtool-to-ios.html" class="sidebar-link  ">Integrate Devtool to iOS</a>
                </li>
              
            
          </ul>
        
      </li>
    
      <li>
          <h3 class="chapter-title">
            
            
              <span class="sidebar-link">Extend</span>
            
          </h3>
          

        
          <ul class="chapter">
            
              
                <li>
                  <a href="/guide/create-a-plugin.html" class="sidebar-link  ">Create a plugin</a>
                </li>
              
            
              
                <li>
                  <a href="/guide/extend-web-render.html" class="sidebar-link  ">Extend Web Renderer</a>
                </li>
              
            
              
                <li>
                  <a href="/guide/extend-android.html" class="sidebar-link  ">Extend Android</a>
                </li>
              
            
              
                <li>
                  <a href="/guide/extend-ios.html" class="sidebar-link current ">Extend iOS</a>
                </li>
              
            
              
                <li>
                  <a href="/guide/extend-js-framework.html" class="sidebar-link  ">Extend JS framework</a>
                </li>
              
            
          </ul>
        
      </li>
    
      <li>
          <h3 class="chapter-title">
            
            
              <span class="sidebar-link">Advanced Guide</span>
            
          </h3>
          

        
          <ul class="chapter">
            
              
                <li>
                  <a href="/guide/advanced/path.html" class="sidebar-link  ">Asset Path</a>
                </li>
              
            
              
                <li>
                  <a href="/guide/advanced/downgrade.html" class="sidebar-link  ">Downgrade</a>
                </li>
              
            
              
                <li>
                  <a href="/guide/advanced/use-vuex-and-vue-router.html" class="sidebar-link  ">Use Vuex and vue-router</a>
                </li>
              
            
              
                <li>
                  <a href="/guide/advanced/app-architecture.html" class="sidebar-link  ">Mobile App Architecture</a>
                </li>
              
            
              
                <li>
                  <a href="/guide/advanced/page-architecture.html" class="sidebar-link  ">Weex Page Architecture</a>
                </li>
              
            
          </ul>
        
      </li>
    
  </ul>
</div>

        <div class="sponsor">
            <a class="sponsor-poster" target="_blank" href="https://render.alipay.com/p/s/taobaonpm_click/weex_banner_click">
              <img src="https://render.alipay.com/p/s/taobaonpm_click/weex_banner" alt="" width="180px">
            </a>
            <div class="sponsor-title">本站点由阿里云赞助支持</div>
          </div>
      </div>
    
    

<article class="article article-type-guide">
  <div class="article-entry" itemprop="articleBody">
    <header class="article-header">
  
    
      <h1 class="article-title" itemprop="name">
        Extend iOS
      </h1>
    
  
  <!-- <time class="article-date" datetime="2018-01-18T03:32:16.487Z">Updated time: 18/01/2018</time> -->
</header>

    <html><head></head><body><h4 class="article-heading"><span id="notice">Notice</span><a href="#notice" class="header-anchor">#</a></h4><p><strong>All of the exported APIs in Weex are controllable and safe, they can not access private APIs or do any system hacks at runtime,  neither can they change the primary purpose of the Application</strong>.</p>
<p><strong>If you are extending your custom modules/components,  be sure NOT to export the ability of Objective-C runtime, be sure NOT to export  dynamic and uncontrolled methods such as <code>dlopen()</code>, <code>dlsym()</code>, <code>respondsToSelector:</code>, <code>performSelector:</code>, <code>method_exchangeImplementations()</code>, be sure NOT to export any private methods. </strong></p>
<h3 class="article-heading"><span id="module-extend">Module extend</span><a href="#module-extend" class="header-anchor">#</a></h3><p>Weex SDK provides only rendering capabilities, rather than have other capabilities, such as network, picture, and URL redirection. If you want these features, you need to implement it.</p>
<p>For example: If you want to implement an address jumping function, you can achieve a Module following the steps below.</p>
<h4 class="article-heading"><span id="step-to-customize-a-module">Step to customize a module</span><a href="#step-to-customize-a-module" class="header-anchor">#</a></h4><ol>
<li>Module<br> customized must implement WXModuleProtocol</li>
<li>A macro named <code>WX_EXPORT_METHOD</code> must be added, as it is the only way to export methods to JavaScript.</li>
<li>The weexInstance should be synthesized. Each module object is bind to a specific instance.</li>
<li>Module methods will be invoked in UI thread, so do not put time consuming operation there. If you want to  execute the whole module methods in other     thread, please implement the method <code>- (NSThread *)targetExecuteThread</code> in protocol. In the way, tasks distributed to this module will be executed in targetExecuteThread.</li>
<li>Weex params can be String or Map.</li>
<li>Module supports to return results to Javascript in callback. This callback is type of <code>WXModuleCallback</code>, the params of which can be String or Map.</li>
</ol>
<figure class="highlight plain"><table><tbody><tr><td class="code"><pre><span class="line">@implementation WXEventModule</span><br><span class="line"></span><br><span class="line">@synthesize weexInstance;</span><br><span class="line">WX_EXPORT_METHOD(@selector(openURL:callback:))</span><br><span class="line"></span><br><span class="line">- (void)openURL:(NSString *)url callback:(WXModuleCallback)callback</span><br><span class="line">{</span><br><span class="line">    NSString *newURL = url;</span><br><span class="line">    if ([url hasPrefix:@&quot;//&quot;]) {</span><br><span class="line">        newURL = [NSString stringWithFormat:@&quot;http:%@&quot;, url];</span><br><span class="line">    } else if (![url hasPrefix:@&quot;http&quot;]) {</span><br><span class="line">        newURL = [NSURL URLWithString:url relativeToURL:weexInstance.scriptURL].absoluteString;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    UIViewController *controller = [[WXDemoViewController alloc] init];</span><br><span class="line">    ((WXDemoViewController *)controller).url = [NSURL URLWithString:newURL];</span><br><span class="line"></span><br><span class="line">    [[weexInstance.viewController navigationController] pushViewController:controller animated:YES];</span><br><span class="line">    callback(@{@&quot;result&quot;:@&quot;success&quot;});</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">@end</span><br></pre></td></tr></tbody></table></figure>
<h4 class="article-heading"><span id="export-synchronous-methods-v0-10">export synchronous methods <span class="api-version">v0.10+</span></span><a href="#export-synchronous-methods-v0-10" class="header-anchor">#</a></h4><p>If you want to export synchronous methods which could make Javascript receive return values from natvie, you can use <code>WX_EXPORT_METHOD_SYNC</code>  macro.</p>
<p>native code:</p>
<figure class="highlight plain"><table><tbody><tr><td class="code"><pre><span class="line">@implementation WXEventModule</span><br><span class="line"></span><br><span class="line">WX_EXPORT_METHOD_SYNC(@selector(getString))</span><br><span class="line"></span><br><span class="line">- (NSString *)getString</span><br><span class="line">{</span><br><span class="line">    return @&quot;testString&quot;;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">@end</span><br></pre></td></tr></tbody></table></figure>
<p>js code:</p>
<figure class="highlight javascript"><table><tbody><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> eventModule = weex.requireModule(<span class="string">&apos;event&apos;</span>)</span><br><span class="line"><span class="keyword">const</span> returnString = syncTest.getString()  <span class="comment">// return &quot;testString&quot;</span></span><br></pre></td></tr></tbody></table></figure>
<p>You can alse return number/array/dictionary except string.</p>
<p><code>notice:</code>  the exported synchronous native method <strong>can only be called on JS thread</strong>. <strong>Do not</strong> do heavy work which will block js execution.</p>
<p><code>notice:</code>  Vue 2.0 has not supported this feature yet.  It will be supported in version 0.12 at the soonest.</p>
<h4 class="article-heading"><span id="register-the-module">Register the module</span><a href="#register-the-module" class="header-anchor">#</a></h4><p>You can register the customized module by calling the method <code>registerModule:withClass</code> in WXSDKEngine.</p>
<figure class="highlight plain"><table><tbody><tr><td class="code"><pre><span class="line">WXSDKEngine.h</span><br><span class="line">/**</span><br><span class="line">*  @abstract Registers a module for a given name</span><br><span class="line">*  @param name The module name to register</span><br><span class="line">*  @param clazz  The module class to register</span><br><span class="line">**/</span><br><span class="line">+ (void)registerModule:(NSString *)name withClass:(Class)clazz;</span><br><span class="line"></span><br><span class="line">[WXSDKEngine registerModule:@&quot;event&quot; withClass:[WXEventModule class]];</span><br></pre></td></tr></tbody></table></figure>
<h3 class="article-heading"><span id="handler-extend">Handler extend</span><a href="#handler-extend" class="header-anchor">#</a></h3><p>Weex SDK doesn&#x2019;t have capabilitis, such as image download &#x3001;navigator operation&#xFF0C;please implement these protocols by yourself.</p>
<h4 class="article-heading"><span id="wximgloaderprotocol">WXImgLoaderProtocol</span><a href="#wximgloaderprotocol" class="header-anchor">#</a></h4><p><font color="gray"><br>Weex SDK has no image download capability, you need to implement <code>WXImgLoaderProtocol</code>. Refer to the following examples.</font></p>
<figure class="highlight plain"><table><tbody><tr><td class="code"><pre><span class="line">WXImageLoaderProtocol.h</span><br><span class="line">@protocol WXImgLoaderProtocol &lt;WXModuleProtocol&gt;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line">    * @abstract Creates a image download handler with a given URL</span><br><span class="line">    * @param imageUrl The URL of the image to download</span><br><span class="line">    * @param imageFrame  The frame of the image you want to set</span><br><span class="line">    * @param options : The options to be used for this download</span><br><span class="line">    * @param completedBlock : A block called once the download is completed.</span><br><span class="line">    image : the image which has been download to local.</span><br><span class="line">    error : the error which has happened in download.</span><br><span class="line">    finished : a Boolean value indicating whether download action has finished.</span><br><span class="line">    */</span><br><span class="line">    -(id&lt;WXImageOperationProtocol&gt;)downloadImageWithURL:(NSString *)url imageFrame:(CGRect)imageFrame userInfo:(NSDictionary *)options completed:(void(^)(UIImage *image,  NSError *error, BOOL finished))completedBlock;</span><br><span class="line">    @end</span><br></pre></td></tr></tbody></table></figure>
<p>Implement above protocol as follows.</p>
<figure class="highlight plain"><table><tbody><tr><td class="code"><pre><span class="line">@implementation WXImgLoaderDefaultImpl</span><br><span class="line">#pragma mark -</span><br><span class="line">#pragma mark WXImgLoaderProtocol</span><br><span class="line"></span><br><span class="line">- (id&lt;WXImageOperationProtocol&gt;)downloadImageWithURL:(NSString *)url imageFrame:(CGRect)imageFrame userInfo:(NSDictionary *)userInfo completed:(void(^)(UIImage *image,  NSError *error, BOOL finished))completedBlock</span><br><span class="line">{</span><br><span class="line">    if ([url hasPrefix:@&quot;//&quot;]) {</span><br><span class="line">        url = [@&quot;http:&quot; stringByAppendingString:url];</span><br><span class="line">    }</span><br><span class="line">    return (id&lt;WXImageOperationProtocol&gt;)[[SDWebImageManager sharedManager] downloadImageWithURL:[NSURL URLWithString:url] options:0 progress:^(NSInteger receivedSize, NSInteger expectedSize) {</span><br><span class="line">    } completed:^(UIImage *image, NSError *error, SDImageCacheType cacheType, BOOL finished, NSURL *imageURL) {</span><br><span class="line">    if (completedBlock) {</span><br><span class="line">        completedBlock(image, error, finished);</span><br><span class="line">    }</span><br><span class="line">    }];</span><br><span class="line">}</span><br><span class="line">@end</span><br></pre></td></tr></tbody></table></figure>
<h4 class="article-heading"><span id="register-the-handler">Register the handler</span><a href="#register-the-handler" class="header-anchor">#</a></h4><p>You can register the handler which implements the protocol by calling  <code>registerHandler:withProtocol</code> in WXSDKEngine.</p>
<figure class="highlight plain"><table><tbody><tr><td class="code"><pre><span class="line">WXSDKEngine.h</span><br><span class="line">/**</span><br><span class="line">* @abstract Registers a handler for a given handler instance and specific protocol</span><br><span class="line">* @param handler The handler instance to register</span><br><span class="line">* @param protocol The protocol to confirm</span><br><span class="line">*/</span><br><span class="line">+ (void)registerHandler:(id)handler withProtocol:(Protocol *)protocol;</span><br><span class="line"></span><br><span class="line">[WXSDKEngine registerHandler:[WXImgLoaderDefaultImpl new] withProtocol:@protocol(WXImgLoaderProtocol)];</span><br></pre></td></tr></tbody></table></figure>
<h2 class="article-heading"><span id="custom-native-components-for-ios">Custom Native Components for iOS</span><a href="#custom-native-components-for-ios" class="header-anchor">#</a></h2><h3 class="article-heading"><span id="component-extend">Component extend</span><a href="#component-extend" class="header-anchor">#</a></h3><p>There are a lot of native components ready to be used in the Weex SDK,  but users always have their own use cases. You might have written an awesome native UI widget in your previous work and just want to wrap up it and export to Weex. So we provide a way to enable developers to create their own custom fully-native components.</p>
<p>This guide will use the implementation of existing component <code>image</code> to show you how to build a native component. It will also assume that you are familiar with iOS programming.</p>
<h4 class="article-heading"><span id="registration">Registration</span><a href="#registration" class="header-anchor">#</a></h4><p>Defining a custom native component is simple. Just call <code>[WXSDKEngine registerComponent:withClass:]</code> with the component&#x2019;s tag name as first argument.</p>
<figure class="highlight plain"><table><tbody><tr><td class="code"><pre><span class="line">[WXSDKEngine registerComponent:@&quot;image&quot; withClass:[WXImageComponent class]];</span><br></pre></td></tr></tbody></table></figure>
<p>Then you can create a <code>WXImageComponent</code> class to represent the implementation of image component.</p>
<p>Now you can use <code>&lt;image&gt;</code> wherever you want in the template.</p>
<figure class="highlight html"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">image</span>&gt;</span><span class="tag">&lt;/<span class="name">image</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
<h4 class="article-heading"><span id="adding-properties">Adding Properties</span><a href="#adding-properties" class="header-anchor">#</a></h4><p>The next thing we can do is to extend some native properties to make the component more powerful. As an image, let&#x2019;s say we should have a <code>src</code> attribute as image&#x2019;s remote source and a <code>resize</code> attribute as image&#x2019;s resize mode(contain/cover/stretch).</p>
<figure class="highlight plain"><table><tbody><tr><td class="code"><pre><span class="line">@interface WXImageComponent ()</span><br><span class="line"></span><br><span class="line">@property (nonatomic, strong) NSString *imageSrc;</span><br><span class="line">@property (nonatomic, assign) UIViewContentMode resizeMode;</span><br><span class="line"></span><br><span class="line">@end</span><br></pre></td></tr></tbody></table></figure>
<p>All of the styles, attributes and events will be passed to the component&#x2019;s initialization method, so here you can store the properties which you are interested in.</p>
<figure class="highlight plain"><table><tbody><tr><td class="code"><pre><span class="line">@implementation WXImageComponent</span><br><span class="line"></span><br><span class="line">- (instancetype)initWithRef:(NSString *)ref type:(NSString *)type styles:(NSDictionary *)styles attributes:(NSDictionary *)attributes events:(NSArray *)events weexInstance:(WXSDKInstance *)weexInstance</span><br><span class="line">{</span><br><span class="line">    if (self = [super initWithRef:ref type:type styles:styles attributes:attributes events:events weexInstance:weexInstance]) {</span><br><span class="line">        _imageSrc = [WXConvert NSString:attributes[@&quot;src&quot;]];</span><br><span class="line">        _resizeMode = [WXConvert UIViewContentMode:attributes[@&quot;resize&quot;]];</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    return self;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">@end</span><br></pre></td></tr></tbody></table></figure>
<p>The properties getted in the attributes are of <code>id</code> type, so we have to convert them to the type we want using a conversion function.  Basic conversion functions can be found in the <code>WXConvert</code> file,  or you can just add your own conversion function.</p>
<h4 class="article-heading"><span id="hooking-render-life-cycle">Hooking Render Life Cycle</span><a href="#hooking-render-life-cycle" class="header-anchor">#</a></h4><p>A Native Component has a life cycle managed by Weex. Weex creates it, layout it, renders it and destroys it.</p>
<p>Weex offers component life cycle hooks that give you visibility into these key moments and the ability to act when they occur.</p>
<table>
<thead>
<tr>
<th style="text-align:center">method</th>
<th>description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">initWithRef:type:&#x2026;</td>
<td>Initializes a new component using the specified  properties.</td>
</tr>
<tr>
<td style="text-align:center">layoutDidFinish</td>
<td>Called when the component has just laid out.</td>
</tr>
<tr>
<td style="text-align:center">loadView</td>
<td>Creates the view that the component manages.</td>
</tr>
<tr>
<td style="text-align:center">viewWillLoad</td>
<td>Called before the load of component&#x2019;s view .</td>
</tr>
<tr>
<td style="text-align:center">viewDidLoad</td>
<td>Called after the component&#x2019;s view is loaded and set.</td>
</tr>
<tr>
<td style="text-align:center">viewWillUnload</td>
<td>Called just before releasing the component&#x2019;s view.</td>
</tr>
<tr>
<td style="text-align:center">viewDidUnload</td>
<td>Called when the component&#x2019;s view is released.</td>
</tr>
<tr>
<td style="text-align:center">updateStyles:</td>
<td>Called when component&#x2019;s style are updated.</td>
</tr>
<tr>
<td style="text-align:center">updateAttributes:</td>
<td>Called when component&#x2019;s attributes are updated.</td>
</tr>
<tr>
<td style="text-align:center">addEvent:</td>
<td>Called when adding an event to the component.</td>
</tr>
<tr>
<td style="text-align:center">removeEvent:</td>
<td>Called when removing an event frome the component.</td>
</tr>
</tbody>
</table>
<p>As in the image component example, if we need to use our own image view, we can override the <code>loadView</code> method.</p>
<figure class="highlight plain"><table><tbody><tr><td class="code"><pre><span class="line">- (UIView *)loadView</span><br><span class="line">{</span><br><span class="line">    return [[WXImageView alloc] init];</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>Now Weex will use <code>WXImageView</code> to render the <code>image</code> component.</p>
<p>As an image component, we will need to fetch the remote image and set it to the image view.  This can be done in <code>viewDidLoad</code> method when the view is created and loaded. <code>viewDidLoad</code> is also the best time to perform additional initialization for your view&#xFF0C; such as content mode changing.</p>
<figure class="highlight plain"><table><tbody><tr><td class="code"><pre><span class="line">- (void)viewDidLoad</span><br><span class="line">{</span><br><span class="line">    UIImageView *imageView = (UIImageView *)self.view;</span><br><span class="line">    imageView.contentMode = _resizeMode;</span><br><span class="line">    imageView.userInteractionEnabled = YES;</span><br><span class="line">    imageView.clipsToBounds = YES;</span><br><span class="line">    imageView.exclusiveTouch = YES;</span><br><span class="line"></span><br><span class="line">    // Do your image fetching and updating logic</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>If image&#x2019;s remote source can be changed, you can also hook the <code>updateAttributes:</code> method to perform your attributes changing logic. Component&#x2019;s view always has been loaded while <code>updateAttributes:</code> or <code>updateStyles:</code> is called.</p>
<figure class="highlight plain"><table><tbody><tr><td class="code"><pre><span class="line">- (void)updateAttributes:(NSDictionary *)attributes</span><br><span class="line">{</span><br><span class="line">    if (attributes[@&quot;src&quot;]) {</span><br><span class="line">        _imageSrc = [WXConvert NSString:attributes[@&quot;src&quot;]];</span><br><span class="line">        // Do your image updating logic</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    if (attributes[@&quot;resize&quot;]) {</span><br><span class="line">        _resizeMode = [WXConvert UIViewContentMode:attributes[@&quot;resize&quot;]];</span><br><span class="line">        self.view.contentMode = _resizeMode;</span><br><span class="line">    }</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<p>Maybe there is even more life cycle hooks you might need to consider, such as <code>layoutDidFinish</code> while layout computing is finished.  If you want to go deeper, check out the <code>WXComponent.h</code> file in the source code.</p>
<p>Now you can use <code>&lt;image&gt;</code> and its attributes wherever you want in the template.</p>
<figure class="highlight html"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">image</span> <span class="attr">style</span>=<span class="string">&quot;your-custom-style&quot;</span> <span class="attr">src</span>=<span class="string">&quot;image-remote-source&quot;</span> <span class="attr">resize</span>=<span class="string">&quot;contain/cover/stretch&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">image</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
<h4 class="article-heading"><span id="component-method">Component Method</span><a href="#component-method" class="header-anchor">#</a></h4><p>from WeexSDK <code>0.9.5</code>, you can define your component method by macro <code>WX_EXPORT_METHOD</code><br>for example:</p>
<figure class="highlight plain"><table><tbody><tr><td class="code"><pre><span class="line">@implementation WXMyComponent</span><br><span class="line"> +WX_EXPORT_METHOD(@selector(focus))</span><br><span class="line"> +- (instancetype)initWithRef:(NSString *)ref type:(NSString *)type styles:(NSDictionary *)styles attributes:(NSDictionary *)attributes events:(NSArray *)events weexInstance:(WXSDKInstance *)weexInstance</span><br><span class="line"> {</span><br><span class="line">     if (self = [super initWithRef:ref type:type styles:styles attributes:attributes events:events weexInstance:weexInstance]) {</span><br><span class="line">         // handle your attributes</span><br><span class="line">         // handle your styles</span><br><span class="line">     }</span><br><span class="line"></span><br><span class="line">     return self;</span><br><span class="line"> }</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"> - (void)focus</span><br><span class="line">   {</span><br><span class="line">   		NSLog(@&quot;you got it&quot;);</span><br><span class="line">   }</span><br><span class="line">@end</span><br></pre></td></tr></tbody></table></figure>
<p>after your registration for your own custom component, now you can call it in your js file.</p>
<figure class="highlight html"><table><tbody><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">mycomponent</span> <span class="attr">ref</span>=<span class="string">&apos;mycomponent&apos;</span>&gt;</span><span class="tag">&lt;/<span class="name">mycomponent</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">  <span class="built_in">module</span>.exports = {</span></span><br><span class="line"><span class="javascript">    created: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>{</span></span><br><span class="line"><span class="javascript">      <span class="keyword">this</span>.$refs.mycomponent.focus();</span></span><br><span class="line"><span class="undefined">    }</span></span><br><span class="line"><span class="undefined">  }</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
</body></html>
    <div class="article-tips">
      <p class="tips-text">
        <a target="_blank" href="https://github.com/apache/incubator-weex-site/tree/master/source/guide/extend-ios.md">Edit this page on GitHub</a>
      </p>
    </div>
  </div>
  
  <footer id="footer">
  <div class="footer-inner">
    <div class="disclaimer">
      <a target="_blank" href="https://incubator.apache.org/">
        <img src="//gw.alicdn.com/tfs/TB1pTBZQFXXXXX9XXXXXXXXXXXX-794-280.png" width="100px" alt="Apache Incubator">
      </a>
      <p>
        <span class="title">Disclaimer:</span>
        <span>Apache Weex is an effort undergoing incubation at The Apache Software Foundation (ASF), sponsored by the Apache Incubator. Incubation is required of all newly accepted projects until a further review indicates that the infrastructure, communications, and decision making process have stabilized in a manner consistent with other successful ASF projects. While incubation status is not necessarily a reflection of the completeness or stability of the code, it does indicate that the project has yet to be fully endorsed by the ASF.</span>
    </div>
    <p class="copyright">
      <img src="//gw.alicdn.com/tfs/TB1bg8SQFXXXXcHXXXXXXXXXXXX-85-170.png" height="16px" alt="Apache"><span>Copyright(c) 2017 The Apache Software Foundation. Licensed under the </span>
      <a target="_blank" href="http://www.apache.org/licenses/LICENSE-2.0">Apache License, Version 2.0</a>
    </p>
  </div>
  <div style="display: none;">
  <script src="//s95.cnzz.com/z_stat.php?id=1261496509&web_id=1261496509" language="JavaScript"></script>
  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-104559823-1', 'auto');
  ga('send', 'pageview');

</script>
</div>

</footer>

</article>

  </div>
</div>


  <script src="/js/reqwest.js"></script>
  <script src="/js/common.js"></script>
  
    
    
    <script src="/js/docsearch.min.js"></script>
    <script type="text/javascript">
    docsearch({
      apiKey: "a6896fe3619315a7f04e9a76bbbbbfcb",
      indexName: "weex",
      inputSelector: '#search-input-header',
      algoliaOptions: {
        hitsPerPage: 10
      }
    });
    </script>
  
</body>
</html>
